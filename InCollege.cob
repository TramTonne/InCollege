IDENTIFICATION DIVISION.
PROGRAM-ID. INCOLLEGE.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO "InCollege-Input.txt"
    ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO "InCollege-Output.txt"
    ORGANIZATION IS LINE SEQUENTIAL.
    SELECT ACCOUNTS-FILE ASSIGN TO "accounts.dat"
    ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD INPUT-FILE.
01 INPUT-RECORD PIC X(80).
FD OUTPUT-FILE.
01 OUTPUT-RECORD PIC X(80).
FD ACCOUNTS-FILE.
01 ACCOUNT-RECORD.
   05 ACCOUNT-USERNAME PIC X(20).
   05 ACCOUNT-PASSWORD PIC X(12).
   05 ACCOUNT-PASSWORD-LENGTH PIC 9(2).
WORKING-STORAGE SECTION.
01 WS-FLAGS.
   05 WS-EOF-FLAG PIC X VALUE 'N'.
   05 WS-VALID-PASSWORD PIC X VALUE 'N'.
   05 WS-ACCOUNT-EXISTS PIC X VALUE 'N'.
   05 WS-LOGGED-IN PIC X VALUE 'N'.
   05 WS-EXIT-FLAG PIC X VALUE 'N'.
01 WS-COUNTERS.
   05 WS-ACCOUNT-COUNT PIC 9(2) VALUE 0.
   05 WS-CHAR-COUNT PIC 9(2) VALUE 0.
   05 WS-UPPER-COUNT PIC 9(2) VALUE 0.
   05 WS-DIGIT-COUNT PIC 9(2) VALUE 0.
   05 WS-SPECIAL-COUNT PIC 9(2) VALUE 0.
01 WS-INPUT-DATA.
   05 WS-MENU-CHOICE PIC X(2).
   05 WS-USERNAME PIC X(20).
   05 WS-PASSWORD PIC X(12).
   05 WS-SKILL-CHOICE PIC X(2).
01 WS-TEMP-VARS.
   05 WS-CHAR PIC X.
   05 WS-INDEX PIC 9(2).
   05 WS-PASSWORD-LENGTH PIC 9(2).
   05 WS-HASHED-PASSWORD PIC X(12).
   05 WS-REVERSE-INDEX PIC 9(2).
   05 WS-WELCOME-PERSONAL PIC X(50).
   05 WS-TRIMMED-USERNAME PIC X(20).
   05 WS-TRIMMED-PASSWORD PIC X(12).
01 WS-MESSAGES.
   05 WS-WELCOME-MSG PIC X(30) VALUE "Welcome to InCollege!".
   05 WS-MENU-OPT1 PIC X(20) VALUE "Log In".
   05 WS-MENU-OPT2 PIC X(25) VALUE "Create New Account".
   05 WS-CHOICE-PROMPT PIC X(20) VALUE "Enter your choice: ".
   05 WS-USERNAME-PROMPT PIC X(25) VALUE "Please enter username: ".
   05 WS-PASSWORD-PROMPT PIC X(25) VALUE "Please enter password: ".
   05 WS-SUCCESS-MSG PIC X(40) VALUE "Account successfully created!".
   05 WS-LIMIT-MSG PIC X(80) VALUE "All permitted accounts have been created, please come back later".
   05 WS-EXISTS-MSG PIC X(30) VALUE "Username already exists!".
   05 WS-INVALID-PASS-MSG PIC X(40) VALUE "Password does not meet requirements!".
   05 WS-PASS-REQ-MSG1 PIC X(40) VALUE "Password must be 8-12 characters,".
   05 WS-PASS-REQ-MSG2 PIC X(40) VALUE "contain 1 uppercase, 1 digit,".
   05 WS-PASS-REQ-MSG3 PIC X(30) VALUE "and 1 special character.".
   05 WS-LOGIN-SUCCESS PIC X(31) VALUE "You have successfully logged in".
   05 WS-LOGIN-FAIL PIC X(46) VALUE "Incorrect username/password, please try again".
   05 WS-UNDER-JOB PIC X(45) VALUE "Job search/internship is under construction.".
   05 WS-UNDER-FIND PIC X(45) VALUE "Find someone you know is under construction.".
   05 WS-UNDER-SKILL PIC X(35) VALUE "This skill is under construction.".
   05 WS-JOB-SEARCH PIC X(30) VALUE "Search for a job".
   05 WS-FIND-SOMEONE PIC X(30) VALUE "Find someone that you know".
   05 WS-LEARN-SKILL PIC X(30) VALUE "Learn a new skill".
   05 WS-SKILL-TITLE PIC X(20) VALUE "Learn a New Skill:".
   05 WS-SKILL1 PIC X(20) VALUE "Skill 1".
   05 WS-SKILL2 PIC X(20) VALUE "Skill 2".
   05 WS-SKILL3 PIC X(20) VALUE "Skill 3".
   05 WS-SKILL4 PIC X(20) VALUE "Skill 4".
   05 WS-SKILL5 PIC X(20) VALUE "Skill 5".
   05 WS-SKILL6 PIC X(15) VALUE "Go Back".
   05 WS-INVALID-CHOICE PIC X(15) VALUE "Invalid choice".
   05 WS-WELCOME-PREFIX PIC X(9) VALUE "Welcome, ".
   05 WS-WELCOME-SUFFIX PIC X(1) VALUE "!".
   05 WS-ERROR-MSG PIC X(50) VALUE "Error: Invalid account record format".
01 WS-STORED-ACCOUNTS.
   05 WS-ACCOUNT OCCURS 5 TIMES.
      10 WS-STORED-USERNAME PIC X(20).
      10 WS-STORED-PASSWORD PIC X(12).
      10 WS-STORED-PASSWORD-LENGTH PIC 9(2).
PROCEDURE DIVISION.
MAIN-PROGRAM.
    PERFORM INITIALIZATION
    PERFORM MAIN-LOOP UNTIL WS-EOF-FLAG = 'Y'
    PERFORM CLEANUP
    STOP RUN.
INITIALIZATION.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE
    PERFORM LOAD-EXISTING-ACCOUNTS
    PERFORM DISPLAY-WELCOME.
LOAD-EXISTING-ACCOUNTS.
    OPEN INPUT ACCOUNTS-FILE
    MOVE 0 TO WS-ACCOUNT-COUNT
    MOVE 'N' TO WS-EOF-FLAG
    PERFORM UNTIL WS-EOF-FLAG = 'Y' OR WS-ACCOUNT-COUNT = 5
        READ ACCOUNTS-FILE
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                IF ACCOUNT-PASSWORD-LENGTH >= 08 AND ACCOUNT-PASSWORD-LENGTH <= 12
                    ADD 1 TO WS-ACCOUNT-COUNT
                    MOVE ACCOUNT-USERNAME TO WS-STORED-USERNAME(WS-ACCOUNT-COUNT)
                    MOVE ACCOUNT-PASSWORD TO WS-STORED-PASSWORD(WS-ACCOUNT-COUNT)
                    MOVE ACCOUNT-PASSWORD-LENGTH TO WS-STORED-PASSWORD-LENGTH(WS-ACCOUNT-COUNT)
                ELSE
                    MOVE WS-ERROR-MSG TO OUTPUT-RECORD
                    WRITE OUTPUT-RECORD
                    DISPLAY WS-ERROR-MSG
                END-IF
        END-READ
    END-PERFORM
    CLOSE ACCOUNTS-FILE
    MOVE 'N' TO WS-EOF-FLAG.
DISPLAY-WELCOME.
    MOVE WS-WELCOME-MSG TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-WELCOME-MSG
    MOVE WS-MENU-OPT1 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-MENU-OPT1
    MOVE WS-MENU-OPT2 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-MENU-OPT2
    MOVE WS-CHOICE-PROMPT TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-CHOICE-PROMPT.
MAIN-LOOP.
    READ INPUT-FILE INTO WS-MENU-CHOICE
        AT END
            MOVE 'Y' TO WS-EOF-FLAG
        NOT AT END
            EVALUATE TRUE
                WHEN WS-MENU-CHOICE = "1" OR WS-MENU-CHOICE = "1 "
                    PERFORM LOGIN-PROCESS
                WHEN WS-MENU-CHOICE = "2" OR WS-MENU-CHOICE = "2 "
                    PERFORM CREATE-ACCOUNT-PROCESS
                WHEN OTHER
                    MOVE WS-INVALID-CHOICE TO OUTPUT-RECORD
                    WRITE OUTPUT-RECORD
                    DISPLAY WS-INVALID-CHOICE
                    PERFORM DISPLAY-WELCOME
            END-EVALUATE
    END-READ.
CREATE-ACCOUNT-PROCESS.
    IF WS-ACCOUNT-COUNT >= 5
        MOVE WS-LIMIT-MSG TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-LIMIT-MSG
    ELSE
        PERFORM GET-USERNAME
        IF WS-EOF-FLAG NOT = 'Y'
            PERFORM GET-PASSWORD
            IF WS-EOF-FLAG NOT = 'Y' AND
               WS-ACCOUNT-EXISTS = 'N' AND
               WS-VALID-PASSWORD = 'Y'
                PERFORM HASH-PASSWORD
                PERFORM SAVE-ACCOUNT
            END-IF
        END-IF
    END-IF
    PERFORM DISPLAY-WELCOME.
GET-USERNAME.
    MOVE WS-USERNAME-PROMPT TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-USERNAME-PROMPT
    READ INPUT-FILE INTO WS-USERNAME
        AT END
            MOVE 'Y' TO WS-EOF-FLAG
        NOT AT END
            MOVE FUNCTION TRIM(WS-USERNAME) TO WS-TRIMMED-USERNAME
            MOVE WS-TRIMMED-USERNAME TO WS-USERNAME
            PERFORM CHECK-USERNAME-EXISTS
    END-READ.
CHECK-USERNAME-EXISTS.
    MOVE 'N' TO WS-ACCOUNT-EXISTS
    MOVE 1 TO WS-INDEX
    PERFORM UNTIL WS-INDEX > WS-ACCOUNT-COUNT
               OR WS-ACCOUNT-EXISTS = 'Y'
        IF FUNCTION TRIM(WS-USERNAME) = FUNCTION TRIM(WS-STORED-USERNAME(WS-INDEX))
            MOVE 'Y' TO WS-ACCOUNT-EXISTS
            MOVE WS-EXISTS-MSG TO OUTPUT-RECORD
            WRITE OUTPUT-RECORD
            DISPLAY WS-EXISTS-MSG
        END-IF
        ADD 1 TO WS-INDEX
    END-PERFORM.
GET-PASSWORD.
    IF WS-ACCOUNT-EXISTS = 'N'
        MOVE WS-PASSWORD-PROMPT TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-PASSWORD-PROMPT
        READ INPUT-FILE INTO WS-PASSWORD
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                MOVE FUNCTION TRIM(WS-PASSWORD) TO WS-TRIMMED-PASSWORD
                MOVE WS-TRIMMED-PASSWORD TO WS-PASSWORD
                PERFORM VALIDATE-PASSWORD
        END-READ
    END-IF.
VALIDATE-PASSWORD.
    MOVE 0 TO WS-CHAR-COUNT
    MOVE 0 TO WS-UPPER-COUNT
    MOVE 0 TO WS-DIGIT-COUNT
    MOVE 0 TO WS-SPECIAL-COUNT
    MOVE FUNCTION TRIM(WS-PASSWORD) TO WS-TRIMMED-PASSWORD
    INSPECT FUNCTION REVERSE(WS-TRIMMED-PASSWORD)
      TALLYING WS-CHAR-COUNT FOR LEADING SPACES
    COMPUTE WS-CHAR-COUNT =
      FUNCTION LENGTH(WS-TRIMMED-PASSWORD) - WS-CHAR-COUNT
    MOVE 1 TO WS-INDEX
    PERFORM UNTIL WS-INDEX > WS-CHAR-COUNT
        MOVE WS-TRIMMED-PASSWORD(WS-INDEX:1) TO WS-CHAR
        IF WS-CHAR >= 'A' AND WS-CHAR <= 'Z'
            ADD 1 TO WS-UPPER-COUNT
        END-IF
        IF WS-CHAR >= '0' AND WS-CHAR <= '9'
            ADD 1 TO WS-DIGIT-COUNT
        END-IF
        IF (WS-CHAR >= '!' AND WS-CHAR <= '/') OR
           (WS-CHAR >= ':' AND WS-CHAR <= '@') OR
           (WS-CHAR >= '[' AND WS-CHAR <= '`') OR
           (WS-CHAR >= '{' AND WS-CHAR <= '~')
            ADD 1 TO WS-SPECIAL-COUNT
        END-IF
        ADD 1 TO WS-INDEX
    END-PERFORM
    IF WS-CHAR-COUNT >= 8 AND WS-CHAR-COUNT <= 12 AND
       WS-UPPER-COUNT >= 1 AND WS-DIGIT-COUNT >= 1 AND
       WS-SPECIAL-COUNT >= 1
        MOVE 'Y' TO WS-VALID-PASSWORD
    ELSE
        MOVE 'N' TO WS-VALID-PASSWORD
        MOVE WS-INVALID-PASS-MSG TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-INVALID-PASS-MSG
        MOVE WS-PASS-REQ-MSG1 TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-PASS-REQ-MSG1
        MOVE WS-PASS-REQ-MSG2 TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-PASS-REQ-MSG2
        MOVE WS-PASS-REQ-MSG3 TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-PASS-REQ-MSG3
    END-IF.
HASH-PASSWORD.
    MOVE 0 TO WS-CHAR-COUNT
    MOVE FUNCTION TRIM(WS-PASSWORD) TO WS-TRIMMED-PASSWORD
    INSPECT FUNCTION REVERSE(WS-TRIMMED-PASSWORD)
      TALLYING WS-CHAR-COUNT FOR LEADING SPACES
    COMPUTE WS-PASSWORD-LENGTH =
      FUNCTION LENGTH(WS-TRIMMED-PASSWORD) - WS-CHAR-COUNT
    MOVE SPACES TO WS-HASHED-PASSWORD
    MOVE WS-PASSWORD-LENGTH TO WS-REVERSE-INDEX
    MOVE 1 TO WS-INDEX
    PERFORM UNTIL WS-INDEX > WS-PASSWORD-LENGTH
        MOVE WS-TRIMMED-PASSWORD(WS-INDEX:1)
          TO WS-HASHED-PASSWORD(WS-REVERSE-INDEX:1)
        SUBTRACT 1 FROM WS-REVERSE-INDEX
        ADD 1 TO WS-INDEX
    END-PERFORM.
SAVE-ACCOUNT.
    ADD 1 TO WS-ACCOUNT-COUNT
    MOVE WS-USERNAME TO WS-STORED-USERNAME(WS-ACCOUNT-COUNT)
    MOVE WS-HASHED-PASSWORD TO WS-STORED-PASSWORD(WS-ACCOUNT-COUNT)
    MOVE WS-PASSWORD-LENGTH TO WS-STORED-PASSWORD-LENGTH(WS-ACCOUNT-COUNT)
    OPEN EXTEND ACCOUNTS-FILE
    MOVE SPACES TO ACCOUNT-RECORD
    STRING FUNCTION TRIM(WS-USERNAME) DELIMITED BY SIZE
           INTO ACCOUNT-USERNAME
    STRING WS-HASHED-PASSWORD DELIMITED BY SIZE
           INTO ACCOUNT-PASSWORD
    MOVE WS-PASSWORD-LENGTH TO ACCOUNT-PASSWORD-LENGTH
    WRITE ACCOUNT-RECORD
    CLOSE ACCOUNTS-FILE
    MOVE WS-SUCCESS-MSG TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SUCCESS-MSG.
LOGIN-PROCESS.
    MOVE 'N' TO WS-LOGGED-IN
    PERFORM UNTIL WS-LOGGED-IN = 'Y' OR WS-EOF-FLAG = 'Y'
        MOVE WS-USERNAME-PROMPT TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-USERNAME-PROMPT
        READ INPUT-FILE INTO WS-USERNAME
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                MOVE FUNCTION TRIM(WS-USERNAME) TO WS-TRIMMED-USERNAME
                MOVE WS-TRIMMED-USERNAME TO WS-USERNAME
        END-READ
        IF WS-EOF-FLAG = 'Y'
            EXIT PERFORM
        END-IF
        MOVE WS-PASSWORD-PROMPT TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-PASSWORD-PROMPT
        READ INPUT-FILE INTO WS-PASSWORD
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                MOVE FUNCTION TRIM(WS-PASSWORD) TO WS-TRIMMED-PASSWORD
                MOVE WS-TRIMMED-PASSWORD TO WS-PASSWORD
        END-READ
        IF WS-EOF-FLAG = 'Y'
            EXIT PERFORM
        END-IF
        PERFORM CHECK-CREDENTIALS
        IF WS-LOGGED-IN = 'N'
            MOVE WS-LOGIN-FAIL TO OUTPUT-RECORD
            WRITE OUTPUT-RECORD
            DISPLAY WS-LOGIN-FAIL
            PERFORM DISPLAY-WELCOME
            MOVE 'N' TO WS-EOF-FLAG
        END-IF
    END-PERFORM
    IF WS-LOGGED-IN = 'Y'
        MOVE WS-LOGIN-SUCCESS TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-LOGIN-SUCCESS
        STRING WS-WELCOME-PREFIX DELIMITED BY SIZE
               FUNCTION TRIM(WS-USERNAME) DELIMITED BY SPACE
               WS-WELCOME-SUFFIX DELIMITED BY SIZE
               INTO WS-WELCOME-PERSONAL
        MOVE WS-WELCOME-PERSONAL TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-WELCOME-PERSONAL
        PERFORM POST-LOGIN-MENU
    END-IF.
CHECK-CREDENTIALS.
    MOVE 'N' TO WS-LOGGED-IN
    PERFORM HASH-PASSWORD
    MOVE 1 TO WS-INDEX
    PERFORM UNTIL WS-INDEX > WS-ACCOUNT-COUNT OR WS-LOGGED-IN = 'Y'
        IF FUNCTION TRIM(WS-USERNAME) = FUNCTION TRIM(WS-STORED-USERNAME(WS-INDEX)) AND
           WS-HASHED-PASSWORD = WS-STORED-PASSWORD(WS-INDEX) AND
           WS-PASSWORD-LENGTH = WS-STORED-PASSWORD-LENGTH(WS-INDEX)
            MOVE 'Y' TO WS-LOGGED-IN
        END-IF
        ADD 1 TO WS-INDEX
    END-PERFORM
    IF WS-LOGGED-IN = 'N'
        MOVE WS-LOGIN-FAIL TO OUTPUT-RECORD
        WRITE OUTPUT-RECORD
        DISPLAY WS-LOGIN-FAIL
    END-IF.
POST-LOGIN-MENU.
    MOVE 'N' TO WS-EXIT-FLAG
    PERFORM UNTIL WS-EOF-FLAG = 'Y' OR WS-EXIT-FLAG = 'Y'
        PERFORM DISPLAY-POST-LOGIN-OPTIONS
        READ INPUT-FILE INTO WS-MENU-CHOICE
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                EVALUATE WS-MENU-CHOICE
                    WHEN "1"
                        MOVE WS-UNDER-JOB TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-JOB
                    WHEN "2"
                        MOVE WS-UNDER-FIND TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-FIND
                    WHEN "3"
                        PERFORM LEARN-SKILL-MENU
                    WHEN OTHER
                        MOVE WS-INVALID-CHOICE TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-INVALID-CHOICE
                END-EVALUATE
                MOVE 'N' TO WS-EOF-FLAG
        END-READ
    END-PERFORM.
DISPLAY-POST-LOGIN-OPTIONS.
    MOVE WS-JOB-SEARCH TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-JOB-SEARCH
    MOVE WS-FIND-SOMEONE TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-FIND-SOMEONE
    MOVE WS-LEARN-SKILL TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-LEARN-SKILL
    MOVE WS-CHOICE-PROMPT TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-CHOICE-PROMPT.
LEARN-SKILL-MENU.
    MOVE 'N' TO WS-EXIT-FLAG
    PERFORM UNTIL WS-EXIT-FLAG = 'Y' OR WS-EOF-FLAG = 'Y'
        PERFORM DISPLAY-SKILLS
        READ INPUT-FILE INTO WS-SKILL-CHOICE
            AT END
                MOVE 'Y' TO WS-EOF-FLAG
            NOT AT END
                EVALUATE WS-SKILL-CHOICE
                    WHEN "1"
                        MOVE WS-UNDER-SKILL TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-SKILL
                    WHEN "2"
                        MOVE WS-UNDER-SKILL TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-SKILL
                    WHEN "3"
                        MOVE WS-UNDER-SKILL TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-SKILL
                    WHEN "4"
                        MOVE WS-UNDER-SKILL TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-SKILL
                    WHEN "5"
                        MOVE WS-UNDER-SKILL TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-UNDER-SKILL
                    WHEN "6"
                        MOVE 'Y' TO WS-EXIT-FLAG
                    WHEN OTHER
                        MOVE WS-INVALID-CHOICE TO OUTPUT-RECORD
                        WRITE OUTPUT-RECORD
                        DISPLAY WS-INVALID-CHOICE
                END-EVALUATE
                MOVE 'N' TO WS-EOF-FLAG
        END-READ
    END-PERFORM.
DISPLAY-SKILLS.
    MOVE WS-SKILL-TITLE TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL-TITLE
    MOVE WS-SKILL1 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL1
    MOVE WS-SKILL2 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL2
    MOVE WS-SKILL3 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL3
    MOVE WS-SKILL4 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL4
    MOVE WS-SKILL5 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL5
    MOVE WS-SKILL6 TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-SKILL6
    MOVE WS-CHOICE-PROMPT TO OUTPUT-RECORD
    WRITE OUTPUT-RECORD
    DISPLAY WS-CHOICE-PROMPT.
CLEANUP.
    CLOSE INPUT-FILE
    CLOSE OUTPUT-FILE.